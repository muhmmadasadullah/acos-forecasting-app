<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ACoS Forecasting Model</title>
  <!-- Load Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Load React and ReactDOM via CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Load Babel for JSX support -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  <!-- Our React application code -->
  <script type="text/babel">
    // ACoS Forecasting App implemented in vanilla React with JSX
    const ACoSForecastingApp = () => {
      // Input states ‚Äì stored as strings for better UX (keeps the current text in the input fields)
      const [cpc, setCpc] = React.useState('1.00');
      const [cvr, setCvr] = React.useState('10.00');
      const [aov, setAov] = React.useState('25.00');
      const [targetACoS, setTargetACoS] = React.useState('25.00');

      // Calculated states
      const [currentACoS, setCurrentACoS] = React.useState(0);
      const [currentROAS, setCurrentROAS] = React.useState(0);
      const [neededCVR, setNeededCVR] = React.useState(0);
      const [neededCPC, setNeededCPC] = React.useState(0);
      const [cvrChange, setCvrChange] = React.useState(0);
      const [cpcChange, setCpcChange] = React.useState(0);

      // Helper functions to format numbers into currency and percentages
      const formatCurrency = (value) => {
        if (isNaN(value)) return '$0.00';
        return '$' + Number(value).toLocaleString('en-US', {
          minimumFractionDigits: 2,
          maximumFractionDigits: 2,
        });
      };

      const formatPercent = (value) => {
        if (isNaN(value)) return '0.00%';
        return Number(value).toFixed(2) + '%';
      };

      // Safely parse input values; treat empty or negative strings as zero
      const parseInputValue = (value) => {
        if (typeof value === 'string' && value.trim() === '') return 0;
        const parsed = parseFloat(value);
        return isNaN(parsed) || parsed < 0 ? 0 : parsed;
      };

      // Compute current inputs for real‚Äëtime calculations
      const currentInputs = {
        cpc: parseInputValue(cpc),
        cvr: parseInputValue(cvr),
        aov: parseInputValue(aov),
        targetACoS: parseInputValue(targetACoS),
      };

      // Recalculate metrics whenever any input changes
      React.useEffect(() => {
        const cpcValue = currentInputs.cpc;
        const cvrValue = currentInputs.cvr;
        const aovValue = currentInputs.aov;
        const targetACoSValue = currentInputs.targetACoS;

        // Guard against invalid or zero values to avoid NaNs and division by zero
        if (cpcValue <= 0 || cvrValue <= 0 || aovValue <= 0 || targetACoSValue <= 0) {
          setCurrentACoS(0);
          setCurrentROAS(0);
          setNeededCVR(0);
          setNeededCPC(0);
          setCvrChange(0);
          setCpcChange(0);
          return;
        }

        const cvrDecimal = cvrValue / 100;
        const targetACoSDecimal = targetACoSValue / 100;

        // Calculate current ACoS and ROAS
        // ACoS = (CPC / CVR) / AOV
        const calculatedACoS = (cpcValue / cvrDecimal) / aovValue;
        const calculatedROAS = 1 / calculatedACoS;

        // Calculate CVR and CPC needed to reach target ACoS
        // CVR needed = CPC / (targetACoS * AOV)
        const calculatedNeededCVR = cpcValue / (targetACoSDecimal * aovValue);
        // CPC needed = targetACoS * AOV * CVR
        const calculatedNeededCPC = targetACoSDecimal * aovValue * cvrDecimal;

        setCurrentACoS(calculatedACoS * 100);
        setCurrentROAS(calculatedROAS);
        setNeededCVR(calculatedNeededCVR * 100);
        setNeededCPC(calculatedNeededCPC);
        setCvrChange((calculatedNeededCVR * 100) - cvrValue);
        setCpcChange(calculatedNeededCPC - cpcValue);
      }, [cpc, cvr, aov, targetACoS]);

      // Handlers for currency and percentage inputs
      const handleCurrencyInput = (value, setter) => {
        // Remove any characters that aren't digits or decimal points
        const cleaned = value.replace(/[^0-9.]/g, '');
        const parts = cleaned.split('.');
        if (parts.length > 2) {
          // If user typed multiple decimals, merge them into a single decimal
          const formatted = parts[0] + '.' + parts.slice(1).join('');
          setter(formatted);
        } else {
          setter(cleaned);
        }
      };

      const handlePercentInput = (value, setter) => {
        // Remove any characters that aren't digits or decimal points
        const cleaned = value.replace(/[^0-9.]/g, '');
        const parts = cleaned.split('.');
        if (parts.length > 2) {
          const formatted = parts[0] + '.' + parts.slice(1).join('');
          setter(formatted);
        } else {
          setter(cleaned);
        }
      };

      // UI rendering
      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
          <div className="max-w-6xl mx-auto">
            {/* Header */}
            <div className="text-center mb-8">
              <div className="flex items-center justify-center gap-3 mb-4">
                <!-- Icon removed to simplify header -->
                <span className="text-3xl"></span>
                <h1 className="text-4xl font-bold text-gray-800">
                  ACoS Forecasting Model
                </h1>
              </div>
              <p className="text-lg text-gray-600">
                Optimize your advertising performance with data‚Äëdriven insights
              </p>
            </div>
            <div className="grid lg:grid-cols-2 gap-8">
              {/* Input Section */}
              <div className="bg-white rounded-xl shadow-lg p-6">
                <div className="flex items-center gap-2 mb-6">
                  <span className="text-2xl">üíµ</span>
                  <h2 className="text-2xl font-semibold text-gray-800">
                    Enter Data&nbsp;üëâ
                  </h2>
                </div>
                <div className="space-y-6">
                  {/* CPC Input */}
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Average Cost‚Äëper‚ÄëClick (CPC)
                      <span className="text-xs text-gray-500 ml-2">e.g., 1.50</span>
                    </label>
                    <div className="relative">
                      <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium">
                        $
                      </span>
                      <input
                        type="text"
                        inputMode="decimal"
                        value={cpc}
                        onChange={(e) =>
                          handleCurrencyInput(e.target.value, setCpc)
                        }
                        placeholder="1.00"
                        className="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-lg font-medium transition-all duration-200 hover:border-gray-400"
                      />
                    </div>
                    <div className="mt-1 text-xs text-gray-500">
                      Enter amount in dollars
                    </div>
                  </div>

                  {/* CVR Input */}
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Average Conversion Rate (CVR)
                      <span className="text-xs text-gray-500 ml-2">e.g., 10.5</span>
                    </label>
                    <div className="relative">
                      <input
                        type="text"
                        inputMode="decimal"
                        value={cvr}
                        onChange={(e) => handlePercentInput(e.target.value, setCvr)}
                        placeholder="10.00"
                        className="w-full pr-8 pl-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-lg font-medium transition-all duration-200 hover:border-gray-400"
                      />
                      <span className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium">
                        %
                      </span>
                    </div>
                    <div className="mt-1 text-xs text-gray-500">
                      Enter percentage (10 = 10%)
                    </div>
                  </div>

                  {/* AOV Input */}
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Average Order Value (AOV)
                      <span className="text-xs text-gray-500 ml-2">e.g., 25.00</span>
                    </label>
                    <div className="relative">
                      <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium">
                        $
                      </span>
                      <input
                        type="text"
                        inputMode="decimal"
                        value={aov}
                        onChange={(e) =>
                          handleCurrencyInput(e.target.value, setAov)
                        }
                        placeholder="25.00"
                        className="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-lg font-medium transition-all duration-200 hover:border-gray-400"
                      />
                    </div>
                    <div className="mt-1 text-xs text-gray-500">
                      Enter amount in dollars
                    </div>
                  </div>

                    {/* Target ACoS Input */}
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Target ACoS
                      <span className="text-xs text-gray-500 ml-2">e.g., 25</span>
                    </label>
                    <div className="relative">
                      <input
                        type="text"
                        inputMode="decimal"
                        value={targetACoS}
                        onChange={(e) =>
                          handlePercentInput(e.target.value, setTargetACoS)
                        }
                        placeholder="25.00"
                        className="w-full pr-8 pl-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-lg font-medium transition-all duration-200 hover:border-gray-400"
                      />
                      <span className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium">
                        %
                      </span>
                    </div>
                    <div className="mt-1 text-xs text-gray-500">
                      Enter percentage (25 = 25%)
                    </div>
                  </div>
                </div>
              </div>
              {/* Results Section */}
              <div className="space-y-6">
                {/* Validation Alert */}
                {(currentInputs.cpc <= 0 ||
                  currentInputs.cvr <= 0 ||
                  currentInputs.aov <= 0 ||
                  currentInputs.targetACoS <= 0) && (
                  <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                    <div className="flex items-center gap-2 text-yellow-800">
                      <span className="text-lg">‚ö†Ô∏è</span>
                      <span className="font-medium">Invalid Input Detected</span>
                    </div>
                    <div className="text-sm text-yellow-700 mt-2">
                      Please enter positive values for all fields to see calculations.
                    </div>
                  </div>
                )}

                {/* Current Metrics */}
                <div className="bg-white rounded-xl shadow-lg p-6">
                  <div className="flex items-center gap-2 mb-4">
                    <span className="text-2xl">üìà</span>
                    <h2 className="text-2xl font-semibold text-gray-800">
                      View Current Metrics&nbsp;üëâ
                    </h2>
                  </div>
                  <div className="grid grid-cols-2 gap-4">
                    <div className="bg-blue-50 p-4 rounded-lg border border-blue-200">
                      <div className="text-sm font-medium text-blue-600 mb-1">
                        Current ACoS
                      </div>
                        <div className="text-2xl font-bold text-blue-800">
                          {formatPercent(currentACoS)}
                        </div>
                    </div>
                    <div className="bg-green-50 p-4 rounded-lg border border-green-200">
                      <div className="text-sm font-medium text-green-600 mb-1">
                        Current ROAS
                      </div>
                      <div className="text-2xl font-bold text-green-800">
                        {currentROAS.toFixed(1)}x
                      </div>
                    </div>
                  </div>
                </div>

                {/* Forecast Changes */}
                <div className="bg-white rounded-xl shadow-lg p-6">
                  <div className="flex items-center gap-2 mb-4">
                    <span className="text-2xl">üéØ</span>
                    <h2 className="text-2xl font-semibold text-gray-800">
                      Forecast Change&nbsp;üëâ
                    </h2>
                  </div>
                  <div className="space-y-4">
                    <div className="bg-purple-50 p-4 rounded-lg border border-purple-200">
                      <div className="text-sm font-medium text-purple-600 mb-3">
                        To achieve {formatPercent(currentInputs.targetACoS)} ACoS target
                      </div>
                      <div className="grid grid-cols-2 gap-4">
                        <div className="bg-white p-3 rounded border">
                          <div className="text-xs text-gray-600 mb-1">CVR Needed</div>
                          <div className="text-lg font-bold text-purple-800">
                            {formatPercent(neededCVR)}
                          </div>
                          <div
                            className={
                              'text-sm font-medium mt-1 ' +
                              (Math.abs(cvrChange) < 0.01
                                ? 'text-gray-500'
                                : cvrChange > 0
                                ? 'text-orange-600'
                                : 'text-green-600')
                            }
                          >
                            {Math.abs(cvrChange) < 0.01
                              ? 'No change needed'
                              : cvrChange > 0
                              ? `‚Üó Increase by ${formatPercent(Math.abs(cvrChange))}`
                              : `‚Üò Decrease by ${formatPercent(Math.abs(cvrChange))}`}
                          </div>
                        </div>
                        <div className="bg-white p-3 rounded border">
                          <div className="text-xs text-gray-600 mb-1">CPC Needed</div>
                          <div className="text-lg font-bold text-purple-800">
                            {formatCurrency(neededCPC)}
                          </div>
                          <div
                            className={
                              'text-sm font-medium mt-1 ' +
                              (Math.abs(cpcChange) < 0.01
                                ? 'text-gray-500'
                                : cpcChange < 0
                                ? 'text-green-600'
                                : 'text-orange-600')
                            }
                          >
                            {Math.abs(cpcChange) < 0.01
                              ? 'No change needed'
                              : cpcChange < 0
                              ? `‚Üò Decrease by ${formatCurrency(Math.abs(cpcChange))}`
                              : `‚Üó Increase by ${formatCurrency(Math.abs(cpcChange))}`}
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Performance Insights */}
                    <div className="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                      <h3 className="font-semibold text-yellow-800 mb-3 flex items-center gap-2">
                        üìä Performance Insights
                      </h3>
                      <div className="text-sm text-yellow-700 space-y-2">
                        {(() => {
                          const currentACoSValue = currentInputs.targetACoS;
                          const difference = currentACoS - currentACoSValue;
                          if (Math.abs(difference) < 0.5) {
                            return (
                              <div className="flex items-center gap-2">
                                <span className="text-green-600">üéØ</span>
                                <span>You're very close to your target ACoS!</span>
                              </div>
                            );
                          } else if (difference > 0) {
                            return (
                              <React.Fragment>
                                <div className="flex items-center gap-2">
                                  <span className="text-orange-500">‚ö†Ô∏è</span>
                                  <span>
                                    Your current ACoS is{' '}
                                    <strong>{difference.toFixed(2)}%</strong> above target
                                  </span>
                                </div>
                                <div className="pl-6 space-y-1">
                                  <div>
                                    ‚Ä¢ <strong>Option A:</strong> Improve CVR by{' '}
                                    {formatPercent(Math.abs(cvrChange))} (optimize landing pages, targeting)
                                  </div>
                                  <div>
                                    ‚Ä¢ <strong>Option B:</strong> Reduce CPC by{' '}
                                    {formatCurrency(Math.abs(cpcChange))} (lower bids, improve Quality Score)
                                  </div>
                                </div>
                              </React.Fragment>
                            );
                          } else {
                            return (
                              <div className="flex items-center gap-2">
                                <span className="text-green-600">üéâ</span>
                                <span>
                                  Excellent! Your current ACoS is{' '}
                                  <strong>{Math.abs(difference).toFixed(2)}%</strong> below target
                                </span>
                              </div>
                            );
                          }
                        })()}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            {/* Formula Reference Section */}
            <div className="mt-8 bg-white rounded-xl shadow-lg p-6">
              <div className="flex items-center gap-2 mb-6">
                <span className="text-2xl">üìö</span>
                <h3 className="text-xl font-semibold text-gray-800">
                  Formula Reference
                </h3>
                <div className="ml-auto text-sm text-gray-500">
                  Live calculations based on your input
                </div>
              </div>
              <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                {/* ACoS Formula */}
                <div className="bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-lg border border-blue-200">
                  <div className="font-semibold text-blue-800 mb-3 flex items-center gap-2">
                    <span className="w-2 h-2 bg-blue-600 rounded-full"></span>
                    ACoS Formula
                  </div>
                  <div className="text-sm text-blue-700 mb-3">
                    <div className="font-mono bg-white p-2 rounded border text-center">
                      ACoS = (CPC √∑ CVR) √∑ AOV
                    </div>
                  </div>
                  <div className="text-xs text-blue-600 space-y-1">
                    <div className="bg-white p-2 rounded border font-mono text-center">
                      ({formatCurrency(currentInputs.cpc)} √∑ {formatPercent(currentInputs.cvr)}) √∑ {formatCurrency(currentInputs.aov)}
                    </div>
                    <div className="bg-blue-200 p-2 rounded font-mono text-center font-semibold">
                      = {formatPercent(currentACoS)}
                    </div>
                  </div>
                </div>

                {/* ROAS Formula */}
                <div className="bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg border border-green-200">
                  <div className="font-semibold text-green-800 mb-3 flex items-center gap-2">
                    <span className="w-2 h-2 bg-green-600 rounded-full"></span>
                    ROAS Formula
                  </div>
                  <div className="text-sm text-green-700 mb-3">
                    <div className="font-mono bg-white p-2 rounded border text-center">
                      ROAS = 1 √∑ ACoS
                    </div>
                  </div>
                  <div className="text-xs text-green-600 space-y-1">
                    <div className="bg-white p-2 rounded border font-mono text-center">
                      1 √∑ {formatPercent(currentACoS)}
                    </div>
                    <div className="bg-green-200 p-2 rounded font-mono text-center font-semibold">
                      = {currentROAS.toFixed(1)}x
                    </div>
                  </div>
                </div>

                {/* Needed CVR Calculation */}
                <div className="bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-lg border border-purple-200">
                  <div className="font-semibold text-purple-800 mb-3 flex items-center gap-2">
                    <span className="w-2 h-2 bg-purple-600 rounded-full"></span>
                    Target CVR Calculation
                  </div>
                  <div className="text-sm text-purple-700 mb-3">
                    <div className="font-mono bg-white p-2 rounded border text-center">
                      Needed CVR = CPC √∑ (Target ACoS √ó AOV)
                    </div>
                  </div>
                  <div className="text-xs text-purple-600 space-y-1">
                    <div className="bg-white p-2 rounded border font-mono text-center">
                      {formatCurrency(currentInputs.cpc)} √∑ ({formatPercent(currentInputs.targetACoS)} √ó {formatCurrency(currentInputs.aov)})
                    </div>
                    <div className="bg-purple-200 p-2 rounded font-mono text-center font-semibold">
                      = {formatPercent(neededCVR)}
                    </div>
                  </div>
                </div>

                {/* Needed CPC Calculation */}
                <div className="bg-gradient-to-br from-orange-50 to-orange-100 p-4 rounded-lg border border-orange-200">
                  <div className="font-semibold text-orange-800 mb-3 flex items-center gap-2">
                    <span className="w-2 h-2 bg-orange-600 rounded-full"></span>
                    Target CPC Calculation
                  </div>
                  <div className="text-sm text-orange-700 mb-3">
                    <div className="font-mono bg-white p-2 rounded border text-center">
                      Needed CPC = Target ACoS √ó AOV √ó CVR
                    </div>
                  </div>
                  <div className="text-xs text-orange-600 space-y-1">
                    <div className="bg-white p-2 rounded border font-mono text-center">
                      {formatPercent(currentInputs.targetACoS)} √ó {formatCurrency(currentInputs.aov)} √ó {formatPercent(currentInputs.cvr)}
                    </div>
                    <div className="bg-orange-200 p-2 rounded font-mono text-center font-semibold">
                      = {formatCurrency(neededCPC)}
                    </div>
                  </div>
                </div>

                {/* Cost per Conversion */}
                <div className="bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-lg border border-gray-200">
                  <div className="font-semibold text-gray-800 mb-3 flex items-center gap-2">
                    <span className="w-2 h-2 bg-gray-600 rounded-full"></span>
                    Cost Per Conversion
                  </div>
                  <div className="text-sm text-gray-700 mb-3">
                    <div className="font-mono bg-white p-2 rounded border text-center">
                      CPC √∑ CVR
                    </div>
                  </div>
                  <div className="text-xs text-gray-600 space-y-1">
                    <div className="bg-white p-2 rounded border font-mono text-center">
                      {formatCurrency(currentInputs.cpc)} √∑ {formatPercent(currentInputs.cvr)}
                    </div>
                    <div className="bg-gray-200 p-2 rounded font-mono text-center font-semibold">
                      ={' '}
                      {currentInputs.cvr > 0
                        ? formatCurrency(currentInputs.cpc / (currentInputs.cvr / 100))
                        : '$0.00'}
                    </div>
                  </div>
                </div>

                {/* Profit Margin */}
                <div className="bg-gradient-to-br from-emerald-50 to-emerald-100 p-4 rounded-lg border border-emerald-200">
                  <div className="font-semibold text-emerald-800 mb-3 flex items-center gap-2">
                    <span className="w-2 h-2 bg-emerald-600 rounded-full"></span>
                    Profit Margin
                  </div>
                  <div className="text-sm text-emerald-700 mb-3">
                    <div className="font-mono bg-white p-2 rounded border text-center">
                      (1 - ACoS) √ó 100
                    </div>
                  </div>
                  <div className="text-xs text-emerald-600 space-y-1">
                    <div className="bg-white p-2 rounded border font-mono text-center">
                      (1 - {formatPercent(currentACoS)}) √ó 100
                    </div>
                    <div className="bg-emerald-200 p-2 rounded font-mono text-center font-semibold">
                      = {formatPercent(100 - currentACoS)}
                    </div>
                  </div>
                </div>
              </div>
              {/* Quick Reference Section */}
              <div className="mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200">
                <h4 className="font-semibold text-gray-800 mb-2">
                  üìñ Quick Reference
                </h4>
                <div className="grid md:grid-cols-2 gap-4 text-sm text-gray-600">
                  <div>
                    <div>
                      <strong>CPC:</strong> Cost Per Click (what you pay for each click)
                    </div>
                    <div>
                      <strong>CVR:</strong> Conversion Rate (% of clicks that become sales)
                    </div>
                    <div>
                      <strong>AOV:</strong> Average Order Value (average revenue per sale)
                    </div>
                  </div>
                  <div>
                    <div>
                      <strong>ACoS:</strong> Advertising Cost of Sales (ad spend / sales revenue)
                    </div>
                    <div>
                      <strong>ROAS:</strong> Return on Ad Spend (sales revenue / ad spend)
                    </div>
                    <div>
                      <strong>Lower ACoS = Higher Profitability</strong>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            {/* Footer */}
            <div className="mt-8 text-center py-6 border-t border-gray-200">
              <div className="text-gray-600">
                Made by{' '}
                <span className="font-semibold text-gray-800">Asadullah</span> ¬∑
                <a
                  href="https://www.linkedin.com/in/muhamadasadullah/"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="text-indigo-600 hover:text-indigo-800 font-medium ml-1 transition-colors duration-200"
                >
                  Connect on LinkedIn
                </a>
              </div>
            </div>
          </div>
        </div>
      );
    };

    // Render the component into the root element
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<ACoSForecastingApp />);
  </script>
</body>
</html>